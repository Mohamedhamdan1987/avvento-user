# Progress Bar ูู ุฅุดุนุงุฑุงุช ุงูุทูุจุงุช

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุฅุถุงูุฉ Progress Bar (ุดุฑูุท ุงูุชูุฏู) ูู ุงูุฅุดุนุงุฑุงุช ุงูุฎุงุตุฉ ุจุงูุทูุจุงุช ูุนูุณ ุญุงูุฉ ุงูุทูุจ ุงูุญุงููุฉ.

## ุงูุชุบููุฑุงุช ุงููุถุงูุฉ

### 1. ุชุญุฏูุซ NotificationService (`lib/core/services/notification_service.dart`)

#### ุฅุถุงูุฉ ุฏุงูุฉ `_getOrderProgress()`
ุชุญุณุจ ูุณุจุฉ ุชูุฏู ุงูุทูุจ ุจูุงุกู ุนูู ุญุงูุชู:

```dart
Map<String, int> _getOrderProgress(OrderStatus status) {
  // ุฅุฌูุงูู ุงูุฎุทูุงุช = 7 (ุจุงุณุชุซูุงุก ุงูููุบู)
  // 1. pending_restaurant (14%)
  // 2. confirmed (28%)
  // 3. preparing (42%)
  // 4. delivery_received (57%)
  // 5. on_the_way (71%)
  // 6. awaiting_delivery (85%)
  // 7. delivered (100%)
  // cancelled (0%)
}
```

#### ุฅุถุงูุฉ ุฏุงูุฉ `showOrderNotification()`
ุชุนุฑุถ ุฅุดุนุงุฑ ูุฎุตุต ููุทูุจุงุช ูุน Progress Bar:

```dart
Future<void> showOrderNotification({
  required String orderId,
  required String title,
  required String body,
  required OrderStatus status,
})
```

**ุงููููุฒุงุช:**
- โ Progress Bar ูุธูุฑ ููุฅุดุนุงุฑุงุช ุงููุชุนููุฉ ุจุงูุทูุจุงุช ููุท
- โ ุงููุณุจุฉ ุงููุฆููุฉ ุชุชุบูุฑ ุญุณุจ ุญุงูุฉ ุงูุทูุจ
- โ ุงูุฅุดุนุงุฑ ูุจูู ูุดุทุงู (`ongoing`) ุญุชู ูุชู ุงูุชุณููู
- โ ูุชู ุฅุฒุงูุชู ุชููุงุฆูุงู (`autoCancel`) ุนูุฏ ุงูุงูุชูุงุก
- โ ูุธูุฑ ูุต ุงูุญุงูุฉ (`status.label`) ูู `subText`

### 2. ุชุญุฏูุซ SocketService (`lib/core/services/socket_service.dart`)

#### ุฅุถุงูุฉ ุฏุนู ููุนููุงุก (Clients)
```dart
// ============ CLIENT ONLY ============
if (userRole == 'client') {
  _notificationSocket!.on('order-status-update', (data) {
    // ุฅุธูุงุฑ ุฅุดุนุงุฑ ูุน Progress Bar ุนูุฏ ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ
  });
}
```

#### ุฅุถุงูุฉ ุฏุงูุฉ `_showOrderStatusNotification()`
ุชุณุชุฎุฏู ูุฅุธูุงุฑ ุฅุดุนุงุฑ ุชููุงุฆู ุนูุฏ ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ:

```dart
void _showOrderStatusNotification({
  required String orderId,
  required OrderStatus status,
  String? title,
  String? body,
})
```

### 3. ุฑุจุท SocketService ุจุตูุญุฉ ุงูุนููู ุงูุฑุฆูุณูุฉ

#### ุชุญุฏูุซ `HomeBinding` (`lib/features/client/home/bindings/home_binding.dart`)
ุฅุถุงูุฉ SocketService ููู dependency injection:

```dart
if (!Get.isRegistered<SocketService>()) {
  Get.put(SocketService(), permanent: true);
}
```

#### ุชุญุฏูุซ `HomePage` (`lib/features/client/home/pages/home_page.dart`)
ุงูุงุชุตุงู ุจุงูู Socket ุนูุฏ ูุชุญ ุงูุตูุญุฉ:

```dart
@override
void initState() {
  // ...
  final socketService = Get.find<SocketService>();
  socketService.connectToNotifications();
}
```

## ููููุฉ ุนูู ุงููุธุงู

### ููุนููุงุก (Clients):
1. ุงูุนููู ููุชุญ ุงูุชุทุจูู โ ูุชู ุงูุงุชุตุงู ุจุงูู Socket
2. ุนูุฏ ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ ูู ุงูุจุงู-ุฅูุฏ:
   - ุงูุจุงู-ุฅูุฏ ูุฑุณู `order-status-update` event
   - SocketService ูุณุชูุจู ุงูุชุญุฏูุซ
   - ูุชู ุนุฑุถ ุฅุดุนุงุฑ ูุน Progress Bar ุญุณุจ ุงูุญุงูุฉ ุงูุฌุฏูุฏุฉ

### ููุณุงุฆููู (Drivers):
- ููุณ ุงูุขููุฉุ ูุน ุฅุถุงูุฉ ุงูุชุญุฏูุซ ููุทูุจุงุช ุงููุชุงุญุฉ

## ูุซุงู ุนูู ุงูุฅุดุนุงุฑ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ ุชุญุฏูุซ ุงูุทูุจ #abc123         โ
โ                                  โ
โ ุญุงูุฉ ุงูุทูุจ: ุฌุงุฑู ุงูุชุญุถูุฑ        โ
โ [โโโโโโโโโโโโโโโโ] 42%          โ
โ                                  โ
โ ุฌุงุฑู ุงูุชุญุถูุฑ                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ุงูุญุงูุงุช ูุงููุณุจ ุงููุฆููุฉ

| ุงูุญุงูุฉ | Status | ุงููุณุจุฉ ุงููุฆููุฉ | ูุตู |
|-------|--------|---------------|------|
| ุจุงูุชุธุงุฑ ูุจูู ุงููุทุนู | `pending_restaurant` | 14% | ุชู ุฅูุดุงุก ุงูุทูุจ |
| ุชู ุชุฃููุฏ ุงูุทูุจ | `confirmed` | 28% | ุงููุทุนู ูุจู ุงูุทูุจ |
| ุฌุงุฑู ุงูุชุญุถูุฑ | `preparing` | 42% | ุงููุทุนู ูุญุถุฑ ุงูุทูุจ |
| ุชู ุงุณุชูุงู ุงูุทูุจ | `delivery_received` | 57% | ุงูุณุงุฆู ุงุณุชูู ุงูุทูุจ |
| ูู ุงูุทุฑูู ุฅููู | `on_the_way` | 71% | ุงูุณุงุฆู ูู ุงูุทุฑูู |
| ูู ุงูุชุธุงุฑ ุงูุชุณููู | `awaiting_delivery` | 85% | ุงูุณุงุฆู ูุตู |
| ุชู ุงูุชุณููู | `delivered` | 100% | ุชู ุงูุชุณููู โ |
| ุชู ุงูุฅูุบุงุก | `cancelled` | 0% | ุชู ุฅูุบุงุก ุงูุทูุจ โ |

## ุงููููุงุช ุงููุนุฏูุฉ

1. โ `lib/core/services/notification_service.dart`
2. โ `lib/core/services/socket_service.dart`
3. โ `lib/features/client/home/bindings/home_binding.dart`
4. โ `lib/features/client/home/pages/home_page.dart`

## ุงูุชูุงูู

- โ **Android**: Progress Bar ูุธูุฑ ูู ุงูุฅุดุนุงุฑุงุช
- โ๏ธ **iOS**: iOS ูุง ูุฏุนู Progress Bar ูู ุงูุฅุดุนุงุฑุงุชุ ููู ูุชู ุนุฑุถ ุงูุฅุดุนุงุฑ ุจุดูู ุนุงุฏู ูุน ุงููุต

## ุงูุงุฎุชุจุงุฑ

ููุงุฎุชุจุงุฑ:
1. ุชุณุฌูู ุงูุฏุฎูู ูุนููู
2. ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ
3. ุชุบููุฑ ุญุงูุฉ ุงูุทูุจ ูู ููุญุฉ ุงููุทุนู ุฃู ุงูุณุงุฆู
4. ุณูุธูุฑ ุฅุดุนุงุฑ ูุน Progress Bar ูุนูุณ ุญุงูุฉ ุงูุทูุจ

## ููุงุญุธุงุช

- ุงูุฅุดุนุงุฑ ูุจูู ูู ุดุฑูุท ุงูุฅุดุนุงุฑุงุช ุญุชู ูุชู ุงูุชุณููู (ongoing notification)
- Progress Bar ูุชุญุฏุซ ุชููุงุฆูุงู ุนูุฏ ูู ุชุบููุฑ ูู ุญุงูุฉ ุงูุทูุจ
- ุงูุฅุดุนุงุฑุงุช ุชุนูู ูู ุงูุฎูููุฉ ูุงูููุฏูุฉ (Foreground & Background)
